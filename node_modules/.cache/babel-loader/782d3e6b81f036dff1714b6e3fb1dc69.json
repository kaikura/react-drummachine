{"ast":null,"code":"var _jsxFileName = \"/Users/agnesepantaleone/Desktop/Drummachine/src/components/instrument.tsx\";\nimport * as React from 'react';\nimport { Time, Transport } from 'tone';\nimport { Clap } from '../engines/clap';\nimport { HiHat } from '../engines/hat';\nimport { Kick } from '../engines/kick';\nimport { Snare } from '../engines/snare';\nimport { Cymbal } from 'src/engines/cymbal';\nexport class Instrument extends React.Component {\n  constructor(props) {\n    super(props);\n    this.ctx = void 0;\n    this.sound = void 0;\n    this.loopId = void 0;\n\n    this.createLoop = () => {\n      if (!this.props.steps) {\n        return;\n      }\n\n      Transport.clear(this.loopId);\n\n      const loop = time => {\n        this.state.steps.forEach((s, i) => {\n          if (s) {\n            this.sound.trigger(time + i * Time('16n').toSeconds());\n          }\n        });\n      };\n\n      this.loopId = Transport.schedule(loop, \"0\");\n    };\n\n    this.handleClick = () => {\n      if (this.props.handleClick) this.props.handleClick(this.props.engine, this.state.steps.slice(0));\n    };\n\n    this.ctx = new AudioContext();\n    this.loopId = 0;\n    this.sound = new Kick(this.ctx);\n    this.state = {\n      steps: [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false]\n    };\n\n    switch (props.engine) {\n      case 'Kick':\n        this.sound = new Kick(this.ctx);\n        break;\n\n      case 'Snare':\n        this.sound = new Snare(this.ctx);\n        break;\n\n      case 'HiHat':\n        this.sound = new HiHat(this.ctx);\n        break;\n\n      case 'Clap':\n        this.sound = new Clap(this.ctx);\n        break;\n\n      case 'Cymbal':\n        this.sound = new Cymbal(this.ctx);\n        break;\n    }\n  }\n\n  componentDidUpdate() {\n    if (this.props.steps && !areEqual(this.props.steps, this.state.steps)) {\n      this.setState({\n        steps: this.props.steps.slice(0)\n      });\n      this.createLoop();\n    }\n  }\n\n  render() {\n    const InstrumentStyle = {\n      height: '3em',\n      width: '7.5em',\n      margin: '0.2em',\n      top: '15px',\n      borderRadius: 10,\n      padding: 5,\n      backgroundColor: this.props.selected ? '#2AC7DC' : '#696969',\n      color: 'white',\n      boxShadow: '2px 2px 5px #222',\n      display: 'inline-block'\n    };\n    return React.createElement(\"div\", {\n      style: InstrumentStyle,\n      onClick: this.handleClick,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }, this.props.engine));\n  }\n\n}\nexport const areEqual = (ar1, ar2) => {\n  if (ar1.length !== ar2.length) return false;\n  let equal = true;\n  ar1.forEach((el, idx) => {\n    if (el !== ar2[idx]) equal = false;\n  });\n  return equal;\n};","map":{"version":3,"sources":["/Users/agnesepantaleone/Desktop/Drummachine/src/components/instrument.tsx"],"names":["React","Time","Transport","Clap","HiHat","Kick","Snare","Cymbal","Instrument","Component","constructor","props","ctx","sound","loopId","createLoop","steps","clear","loop","time","state","forEach","s","i","trigger","toSeconds","schedule","handleClick","engine","slice","AudioContext","componentDidUpdate","areEqual","setState","render","InstrumentStyle","height","width","margin","top","borderRadius","padding","backgroundColor","selected","color","boxShadow","display","ar1","ar2","length","equal","el","idx"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { Time, Transport } from 'tone';\nimport { Clap } from '../engines/clap';\nimport { InstrumentEngine } from '../engines/engines';\nimport { HiHat } from '../engines/hat';\nimport { Kick } from '../engines/kick';\nimport { Snare } from '../engines/snare';\nimport { Cymbal } from 'src/engines/cymbal';\n\nexport interface InstrumentProps {\n    engine: string;\n    steps?: boolean[];\n    handleClick?: (engine: string, steps:boolean[]) => void;\n    selected?: boolean;\n}\n\nexport class Instrument extends React.Component<InstrumentProps, any> {\n    private ctx: AudioContext;\n    private sound: InstrumentEngine;\n    private loopId: number;\n\n    constructor(props) {\n        super(props);\n        this.ctx = new AudioContext;\n        this.loopId=0;\n        this.sound = new Kick(this.ctx);\n        this.state = {\n            steps: [false, false, false, false, false, false, false, false,\n                false, false, false, false, false, false, false, false],\n        }\n        switch (props.engine) {\n            case 'Kick':\n                this.sound = new Kick(this.ctx);\n                break;\n            case 'Snare':\n                this.sound = new Snare(this.ctx);\n                break;\n            case 'HiHat':\n                this.sound = new HiHat(this.ctx);\n                break;\n            case 'Clap':\n                this.sound = new Clap(this.ctx);\n                break;\n            case 'Cymbal':\n                this.sound = new Cymbal(this.ctx);\n                break;\n        }\n    }\n\n    componentDidUpdate() {\n        if (this.props.steps && !areEqual(this.props.steps, this.state.steps)) {\n            this.setState({\n                steps: this.props.steps.slice(0),\n            });\n            this.createLoop();\n        }\n    }\n\n    createLoop = () => {\n        if (!this.props.steps) { return; }\n        Transport.clear(this.loopId);\n        const loop = (time: number) => {\n            this.state.steps.forEach((s, i) => {\n                if (s) {\n                    this.sound.trigger(time + i * Time('16n').toSeconds())\n                }\n            });\n        }\n        this.loopId = Transport.schedule(loop, \"0\");\n    }\n\n    handleClick = () => {\n        if (this.props.handleClick) this.props.handleClick(this.props.engine, this.state.steps.slice(0));\n    }\n\n    render() {\n        const InstrumentStyle = {\n           \n            height: '3em',\n            width : '7.5em',\n            margin: '0.2em',\n            top: '15px',\n            borderRadius: 10,\n            padding: 5,\n            backgroundColor: this.props.selected ? '#2AC7DC' : '#696969',\n            color: 'white',\n            boxShadow: '2px 2px 5px #222',\n            display: 'inline-block'\n        }\n        return (\n            <div style={InstrumentStyle} onClick={this.handleClick}>\n                <p>{this.props.engine}</p>\n            </div >\n        )\n    }\n}\n\nexport const areEqual = (ar1, ar2) => {\n    if (ar1.length !== ar2.length) return false;\n    let equal = true;\n    ar1.forEach((el, idx) => {\n        if (el !== ar2[idx]) equal = false;\n    });\n    return equal;\n}"]},"metadata":{},"sourceType":"module"}